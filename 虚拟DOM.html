<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>

<body>
  <div id="app"></div>
  <script>
    // 1.根据js数据,创建js的DOM结构
    class Element {
      constructor(type, props, children) {
        this.type = type;
        this.props = props;
        this.children = children;
      }
    }

    function dom(type, props, ...children) {
      return new Element(type, props, children);
    }


    // 2.将js的DOM结构生成实际的DOM插入到页面中
    function render(vDom) {
      let el = document.createElement(vDom.type);
      Object.keys(vDom.props).forEach(key => {
        setAttr(el, key, vDom.props[key]);
      });

      vDom.children.forEach(child => {
        const subEl = (child instanceof Element) ? render(child) : document.createTextNode(child);
        el.appendChild(subEl);
      })

      return el;
    }

    function setAttr(el, key, val) {
      switch (key) {
        case 'value':
          if (el.tagName.toLowerCase() === 'input' || el.tagName.toLowerCase() === 'textarea') {
            el.value = val;
          } else {
            el[key] = val;
          }
          break;

        case 'style':
          el.style.cssText = val;
          break;

        default:
          el.setAttribute(key, val);
      }
    }
    function createPage(target, dom) {
      document.getElementById(target).appendChild(dom);
    }

    const objdata = dom(
      'div',
      { class: 'my-div' },
      dom('p', { class: 'my-p' }, '第一行'),
      dom('p', { class: 'my-p' }, '法法行'),
      dom('p', { class: 'my-p' }, '认为他')
    )

    const objDom = render(objdata);
    createPage('app', objDom);

  // 3.用深度优先遍历算法比较变化的数据,打上补丁

  // 4.将补丁运用到真正的DOM结构

  </script>
</body>

</html>