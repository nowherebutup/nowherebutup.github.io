webpackJsonp([22],{PWxy:function(e,t){},PlpJ:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=s("bOdI"),r=s.n(i),n=(s("fivE"),s("pD4b")),c=(s("Asns"),s("RQxp")),h=(s("OWWB"),s("1fWZ")),d=(s("eqfM"),s("/QYm")),o=(s("k3b4"),s("+2ln")),l=(s("4yKu"),s("wolx")),p=(s("nOaS"),s("pIDD")),u=(s("FO5P"),s("woHG")),f=s("/8ty"),v=s("AArU"),m=s("DEHg"),y=s("SIH0"),g=s.n(y),b=s("GKmE"),D={computed:{showBack:function(){return this.lastParentDep.id||2===this.tabType||this.lastParentDep.isUser}},components:(a={AddressList:f.a,BusinessCard:v.a},r()(a,u.a.name,u.a),r()(a,p.a.name,p.a),r()(a,l.a.name,l.a),r()(a,o.a.name,o.a),r()(a,d.a.name,d.a),r()(a,h.a.name,h.a),r()(a,c.a.name,c.a),r()(a,n.a.name,n.a),a),watch:{keyWord:function(){this.fuzzySearch()}},data:function(){return{tabType:1,oldType:1,loading:!1,isSearch:!1,keyWord:"",orgId:JSON.parse(Object(b.d)("userInfo")).orgId,searchUserList:[],searchDeptList:[],treeList:[],list:[],ulist:[],curDeptName:"中通服咨询设计研究院",curDeptObj:{},curUser:{},hasBtm:!1,lastParentDep:{id:"",isUser:!1},defaultAvatar:g.a}},created:function(){Object(b.h)("searchUsers",""),Object(b.h)("searchDeps",""),this.getInitData("")},methods:{isValidImg:function(e){return Object(b.f)(e)},fuzzySearch:function(){var e=this;3!==this.tabType&&(this.oldType=this.tabType),this.keyWord?(this.tabType=3,this.isSearch=!0,Object(m.a)({orgId:this.orgId,keyWord:this.keyWord}).then(function(t){(e.isSearch=!1,e.clearList(),t&&t.success)?((t.data.user||[]).forEach(function(t){e.searchUserList.push(t)}),(t.data.dep||[]).forEach(function(t){e.searchDeptList.push(t)})):Object(d.a)("获取数据失败！")})):this.tabType=this.oldType},clearList:function(){var e=this.searchUserList;e.splice(0,e.length);var t=this.searchDeptList;t.splice(0,t.length)},getDeptsArr:function(e){this.$router.push({path:"/contact/org",query:{depId:e}})},getInitData:function(e){var t=this;Object(m.b)({orgId:this.orgId,depId:e}).then(function(e){if(e&&e.success){var s=t.list;s.splice(0,s.length),e.data.forEach(function(e){t.lastParentDep.id=e.parentId,t.lastParentDep.isUser=!1,e.text=e.depName,s.push(e)})}else d.a.fail("获取数据失败！")})},getDeptsUsers:function(e){var t=this;this.loading=!0,Object(m.d)({orgId:this.orgId,depId:e}).then(function(e){if(t.loading=!1,e&&e.success){var s=t.ulist;s.splice(0,s.length),e.data.forEach(function(e){s.push(e)})}else d.a.fail("获取该部门下的人员失败！")})},openNext:function(e){console.log(e),e.leaf?this.$router.push({path:"/contact/users",query:{depId:e.id}}):this.$router.push({path:"/contact/org",query:{depId:e.id}})},toSearch:function(){this.$router.push({path:"/contact/search"})},toClickUserPage:function(e){this.curUser=e,this.lastParentDep.isUser=!0,this.lastParentDep.id=e.parentId,this.tabType=4},onClickLeft:function(){1===this.tabType?this.getDeptsArr(this.lastParentDep.id):2===this.tabType?(this.tabType=1,this.getDeptsArr(this.lastParentDep.id)):3===this.tabType?this.tabType=this.oldType:4===this.tabType?(this.tabType=2,this.getDeptsUsers(this.curUser.depId)):5===this.tabType&&(this.tabType=3),console.log(this.lastParentDep.id)},backIndex:function(){this.$router.isBack=!0,this.$router.go(-1)},getSearchUser:function(e){this.$router.push({path:"/contact/detail",query:{phone:e.phone}})},getSearchDept:function(e){this.$router.push({path:"/contact/users",query:{depId:e.id}})},selectIndexBtmFun:function(e){this.hasBtm=e},removeIndexBtmFun:function(e){this.hasBtm=e}}},I={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"address"},[s("van-nav-bar",{attrs:{fixed:"",title:e.curDeptName}}),e._v(" "),s("van-cell",[s("van-search",{staticClass:"address-search border",attrs:{placeholder:"请输入关键字搜索",shape:"round"},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}})],1),e._v(" "),s("div",{staticClass:"address-main"},e._l(e.list,function(t,a){return s("div",{key:a,staticClass:"address-item border",on:{click:function(s){return e.openNext(t)}}},[s("div",{staticClass:"address-item-left"},[s("van-icon",{staticClass:"iconfont",attrs:{color:"#3badfe",size:"1.2rem","class-prefix":"icon",name:"wenjianjia"}})],1),e._v(" "),s("div",[e._v(e._s(t.text))])])}),0),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.keyWord,expression:"keyWord"}],staticClass:"address-main"},[s("div",{directives:[{name:"show",rawName:"v-show",value:0===e.searchUserList.length&&0===e.searchDeptList.length,expression:"searchUserList.length === 0 && searchDeptList.length === 0"}],staticClass:"card-empty"},[s("div",{staticClass:"card-empty-img"}),e._v(" "),e.isSearch?s("div",{staticClass:"card-empty-tip1"},[e._v("正在搜索中...")]):s("div",{staticClass:"card-empty-tip1"},[e._v("搜索无结果")])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:(e.searchUserList||e.searchDeptList)&&(e.searchUserList.length>0||e.searchDeptList.length>0),expression:"\n        (searchUserList || searchDeptList) &&\n          (searchUserList.length > 0 || searchDeptList.length > 0)\n      "}]},[e._l(e.searchDeptList,function(t){return s("van-cell",{key:t.deptId,on:{click:function(s){return e.getSearchDept(t)}}},[s("van-icon",{staticClass:"address-has-cell-img iconfont",attrs:{color:"#3badfe",size:"1.2rem","class-prefix":"icon",name:"wenjianjia"}}),e._v(" "),s("div",{staticClass:"address-has-cell-span"},[s("div",{staticClass:"cell-span-name"},[e._v(e._s(t.depName))])])],1)}),e._v(" "),e._l(e.searchUserList,function(t){return s("van-cell",{key:t.userId,on:{click:function(s){return e.getSearchUser(t)}}},[s("img",{staticClass:"address-has-cell-img address-has-cell-cri",attrs:{src:e.isValidImg(t.avatar)||e.defaultAvatar,alt:""}}),e._v(" "),s("div",{staticClass:"address-has-cell-span"},[s("div",{staticClass:"cell-span-name"},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"cell-span-dept"},[e._v(e._s(t.deptName))])])])})],2)])],1)},staticRenderFns:[]};var _=s("VU/8")(D,I,!1,function(e){s("PWxy")},"data-v-1d87425a",null);t.default=_.exports}});